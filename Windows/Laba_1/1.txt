@echo off
setlocal enabledelayedexpansion

for /f %%a in ('dir /b /ad-h') do set /a count+=1
echo Number of non-hidden subdirectories in "%dir%": !count!

